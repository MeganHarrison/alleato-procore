{
  "version": "1.0.0",
  "lastUpdated": "2026-01-12",
  "description": "Pattern library for preventing recurring AI mistakes in Alleato-Procore",
  "patterns": [
    {
      "id": "networkidle-timeout",
      "name": "NetworkIdle Timeout",
      "type": "error",
      "severity": "CRITICAL",
      "file": "errors/networkidle-timeout.md",
      "triggers": ["playwright", "test", "waitForLoadState", "networkidle", "timeout", "navigation", "goto"],
      "solution": "solutions/domcontentloaded-pattern.md",
      "summary": "Use domcontentloaded instead of networkidle for Playwright navigation"
    },
    {
      "id": "auth-fixture-missing",
      "name": "Auth Fixture Missing",
      "type": "error",
      "severity": "CRITICAL",
      "file": "errors/auth-fixture-missing.md",
      "triggers": ["playwright", "test", "api", "request", "401", "403", "unauthorized", "forbidden", "auth", "cookie", "bearer", "token"],
      "solution": "solutions/auth-fixture-pattern.md",
      "summary": "Import from fixtures instead of @playwright/test for authenticated API requests"
    },
    {
      "id": "route-param-mismatch",
      "name": "Route Parameter Mismatch",
      "type": "error",
      "severity": "CRITICAL",
      "file": "errors/route-param-mismatch.md",
      "triggers": ["route", "[projectId]", "[id]", "param", "dynamic", "api", "app router", "next.js", "page.tsx", "route.ts"],
      "solution": null,
      "summary": "Always use [projectId] not [id] for project routes - check existing routes before creating"
    },
    {
      "id": "premature-completion",
      "name": "Premature Completion Claims",
      "type": "error",
      "severity": "CRITICAL",
      "file": "errors/premature-completion.md",
      "triggers": ["complete", "done", "finished", "verified", "passing", "working", "ready"],
      "solution": "solutions/verification-gate-pattern.md",
      "summary": "Never claim completion without gate checksums and verification evidence"
    },
    {
      "id": "fk-constraint-user",
      "name": "Foreign Key Constraint on User Profile",
      "type": "error",
      "severity": "HIGH",
      "file": "errors/fk-constraint-user.md",
      "triggers": ["foreign key", "fk", "constraint", "profiles", "created_by", "user_id", "auth.users", "insert", "violates"],
      "solution": null,
      "summary": "Check if user profile exists before setting created_by foreign key"
    },
    {
      "id": "supabase-types-stale",
      "name": "Stale Supabase Types",
      "type": "error",
      "severity": "HIGH",
      "file": "errors/supabase-types-stale.md",
      "triggers": ["supabase", "database", "types", "schema", "migration", "column", "table", "Property does not exist"],
      "solution": null,
      "summary": "Always run supabase gen types before writing database code"
    }
  ],
  "solutions": [
    {
      "id": "domcontentloaded-pattern",
      "name": "DOMContentLoaded Navigation Pattern",
      "file": "solutions/domcontentloaded-pattern.md",
      "solves": ["networkidle-timeout"],
      "summary": "Use domcontentloaded and element selectors instead of networkidle"
    },
    {
      "id": "auth-fixture-pattern",
      "name": "Universal Auth Fixture Pattern",
      "file": "solutions/auth-fixture-pattern.md",
      "solves": ["auth-fixture-missing"],
      "summary": "Create and use auth fixture for all API tests"
    },
    {
      "id": "verification-gate-pattern",
      "name": "Verification Gate Pattern",
      "file": "solutions/verification-gate-pattern.md",
      "solves": ["premature-completion"],
      "summary": "Use enforce-gates.ts to generate checksums before claiming completion"
    }
  ],
  "injectionRules": {
    "description": "Rules for auto-injecting patterns into agent prompts",
    "matchAny": true,
    "maxPatternsPerPrompt": 5,
    "priorityOrder": ["CRITICAL", "HIGH", "MEDIUM", "LOW"]
  },
  "usage": {
    "forAgents": "Read relevant patterns before starting work. Match task keywords against trigger arrays.",
    "forHumans": "Review patterns when debugging recurring issues.",
    "forAutomation": "Parse index.json to inject patterns into agent prompts based on triggers."
  }
}
